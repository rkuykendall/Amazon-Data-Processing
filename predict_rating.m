%x(1,:) = [3.33333333333333 3.33333333333333 4.33333333333333 5 2 2.5 3.33333333333333 3.5 3.5 3.25 3.75 3.33333333333333 3 5 4 4 3.55555555555556 3.11111111111111 2.66666666666667 3 4 4.5 5 5 4.33333333333333 4 3.6 4.3 4.83333333333333 3.4 3.5 4 3.66666666666667 3.5 3.75 3.66666666666667 2.66666666666667 1.5 2 2 3.16666666666667 4.33333333333333 4 4.5 5 4.75 4.6 4 3.75 4.25 5 4.25 3.5 3.5 3.33333333333333 3.75 4.6 3.875 3.25 3.5 3.66666666666667 3.25 3 3.33333333333333 3.71428571428571 3.14285714285714 2.75 4.5 4 3.5 4 4.42857142857143 4 3.66666666666667 4.14285714285714 4.125 3.66666666666667 3.8 3.33333333333333 2 3.5 3.75 3 3.5 4.25 3.66666666666667 3.25 3.2 3.85714285714286 4 3.33333333333333 4.33333333333333 4.75 4.4 4 3.57142857142857 3 3 3.5 2 3 3.42857142857143 3.71428571428571 4.66666666666667 3.25 2.75 3.5 3.5 3.25 3.25 4.5 4.4 3.8 3 3.8 3.55555555555556 2.83333333333333 4 4.5 4 4.25 4.46153846153846 4 3.5 4.33333333333333 3.8 3.6 3 3.125 3.5 3.5 4.25 4.42857142857143 4.33333333333333 4.2 4.25 4.66666666666667 4.4 4.375 4.14285714285714 3.8 4 3.71428571428571 3 3.42857142857143 3.66666666666667 4.4 4.66666666666667 4.5 4.4 4.25 4 4 4.5 4.33333333333333 4 4 3 3 3.16666666666667 3.33333333333333 4 5 5 4.5 3 2 1.75 3 4.33333333333333 5 3.75 2.5 2.66666666666667 3 4 4 3 2 3.8 4.4 4 4 5 5 4 4 4.5 3 3.75 4.5 4 4.66666666666667 4.66666666666667 4 3 3.5 4 5 5];
%x(2,:) = [3.11901983663944 4.05950991831972 5 5 5 2.33333333333333 2.6 2 3.2 4.66666666666667 4 4.4 3.8 3.33333333333333 5 1 1 5 4.5 4 2 1.66666666666667 2 3 4 5 5 4.5 4 4 4.5 4.28571428571429 4.33333333333333 5 2 2 1 1 2.5 4 4 1 1 2 1.66666666666667 1 1 1 1 1 1 1 1 1 1 4 3 2 1.66666666666667 1.33333333333333 1 2 3 3.16666666666667 3.5 5 5 3.66666666666667 2.33333333333333 1 1 1 1 1 1 2.75 2.75 2.83333333333333 2.91666666666667 3 3 3 3 3 3 3 3 2.33333333333333 1 1 5 4.66666666666667 4.5 3.625 2.75 1.875 1 1 1 1 1.2 1.4 1.6 1.8 2 2 2.28571428571429 2.57142857142857 2.85714285714286 3.14285714285714 3.42857142857143 3.71428571428571 4 4.5 5 3.5 2 2 1 1.5 2 2.25 2.5 2.75 3 3.25 3.5 3.75 4 4 4.5 5 5 4.75 4.5 4.25 4 3.75 3.5 3.25 3 2.75 2.5 2.25 2 1.75 1.5 1.25 1 1 5 5 3 1 1 2 3 3 2 1 1 1.75 2.5 3.25 4 4 4 4 4 4 3.8 3.6 3.4 3.2 3 2.8 2.6 2.4 2.2 2 1.8 1.6 1.4 1.2 1 1 2 2 2 2 2 2 2 2 2 2 2 2 2 2];
%x(3,:) = [4.56458333333333 4.6734375 4.78229166666666 4.89114583333333 5 5 5 5 5 5 5 5 4.5 4.66666666666667 5 5 5 5 1 1 4 4.33333333333333 4.5 4.75 5 5 5 2 3.5 5 5 5 5 5 5 5 5 5 4 4 5 5 5 5 5 4.5 4.5 5 5 4.8 4.83333333333333 5 5 5 4.5 4.8 4.71428571428571 4.33333333333333 4.625 4.8 3.33333333333333 3.5 4.5 5 5 4.75 4.5 5 5 5 3.66666666666667 3 4 3.75 4.75 4.8 4 4.5 4.83333333333333 4.66666666666667 5 5 5 4.6 4.5 4.42857142857143 3.5 4.11111111111111 5 5 5 5 4.71428571428571 4.6 5 5 4.6 4.5 4 4 5 5 1 3.66666666666667 3.66666666666667 2.66666666666667 4.5 4.83333333333333 5 5 4.7 4.3 4.33333333333333 4.23529411764706 4.44444444444444 4.65217391304348 4.53846153846154 4.64285714285714 4.78571428571429 5 4.75 4.83333333333333 4.7 4.16666666666667 4.57142857142857 4.85714285714286 4.83333333333333 4.91666666666667 4.73684210526316 4.58333333333333 5 4.55555555555556 4.0625 4.38095238095238 4.8 4.84615384615385 5 5 5 5 5 5 4.2 3.4 3.57142857142857 4.14285714285714 5 5 5 5 3.75 3 3.25 3.5 4.66666666666667 5 5 5 2 2.33333333333333 4.16666666666667 5 5 4.83333333333333 4.66666666666667 3.33333333333333 2.5 5 5 5 5 4.71428571428571 4.71428571428571 4.66666666666667 4.6 5 5 4.33333333333333 4.6 5 5 5 5 5 4.6 4.66666666666667 5 5 5 5 4.66666666666667 4 3.88888888888889 3.77777777777778 3.66666666666667 4 5 5 4.25 3.25];
%x(4,:) = [4.59523809523809 4.625 4.73684210526316 4.5 4.59459459459459 4.86206896551724 5 5 4.76470588235294 4.55555555555556 4.72413793103448 4.90697674418605 5 4.80952380952381 4.82352941176471 4.79166666666667 4.83333333333333 5 4.97297297297297 4.96296296296296 4.94117647058824 4.9375 5 5 5 5 5 5 5 5 4 3 2 1 2.6 2.14285714285714 1 3.5 2.66666666666667 1 1 1 1 2 4.5 3.33333333333333 2 1 1.33333333333333 1.5 1 1.4 1.8 2.2 2.6 3 3.4 3.8 4.2 4.6 5 3.2 2 2 2.5 3 3.4 2.6 2 2.6 2 2.75 3 2.66666666666667 2.66666666666667 1 1 1 1 5 4.5 2.5 1 1 1 1 1 1 1 1.8 2.22222222222222 2.16666666666667 1 1.22222222222222 1.44444444444444 1.66666666666667 1.88888888888889 2.11111111111111 2.33333333333333 2.55555555555556 2.77777777777778 3 3 3.5 3.5 1.5 1.33333333333333 2 2 1 3 5 4 3 2.5 3.5 4 2.5 3 2.66666666666667 2.25 3 3 1 5 3.5 2.25 2.5 4 5 2.5 2.5 1 1.33333333333333 1.5 4.5 4.5 4.75 5 2.25 2 3 1.8 1 1 2.66666666666667 2.66666666666667 2.25 1.83333333333333 1.41666666666667 1 2.33333333333333 5 1 1 2 2.66666666666667 3 4 5 5 3.66666666666667 2.33333333333333 1 1 1.75 2.5 2.5 1.75 1 3 3.66666666666667 2.83333333333333 3.2 2.33333333333333 2.33333333333333 3 3 4 2 3 3.75 3.5 3.75 4 4.5 5 5 5 3.66666666666667 2.33333333333333 1 1 1 1 1 1 1 1 1];
%x(5,:) = [2.71428571428571 2.2 4.5 3.625 3.33333333333333 5 4 3.66666666666667 3.66666666666667 2 2 3 3.66666666666667 3.75 3.33333333333333 4 3.2 2 2 2.5 2 2.66666666666667 3.5 4 4 2.66666666666667 2.66666666666667 3 3 2 3 4 4.5 5 5 2.33333333333333 2.5 2.66666666666667 2.75 2.75 2.5 2.5 3.25 4 4 4 3.5 3.2 3.42857142857143 3.5 2 1 3 3.33333333333333 2.66666666666667 2.5 4 5 4 2.5 2.8 2.83333333333333 3 2.8 2.77777777777778 3 3.25 3.5 3 3 3.33333333333333 2.33333333333333 2.75 4 4.66666666666667 4.8 4.16666666666667 3.4 2 3.5 5 3.5 2 3 2.66666666666667 1.83333333333333 2 4 3.33333333333333 3.75 4 3.2 3 1.5 1.5 2 2.83333333333333 3 3.5 4 3.5 3 3.42857142857143 3.66666666666667 2.5 3 2.33333333333333 1.33333333333333 1.33333333333333 2.75 3.66666666666667 3 4 4.5 3.8 2 3 4 4 3.5 3.33333333333333 4 5 4 3 3 2.5 2.66666666666667 3.4 2.85714285714286 2.5 4 2.66666666666667 1.66666666666667 1 1 5 5 4.2 3.375 1.75 3.33333333333333 3.2 2.33333333333333 5 4.33333333333333 4 2 2 2.5 3 3.66666666666667 4 3.6 4 4.66666666666667 3.5 3 3.5 4 4.5 5 5 3.75 3.33333333333333 2 3.33333333333333 3.5 3.33333333333333 3.33333333333333 3 3.33333333333333 3 2.5 2.66666666666667 3 2.66666666666667 2 1 1 1.25 1.5 1.5 4.33333333333333 4.33333333333333 3 3 5 5 4.66666666666667 4.33333333333333 4 4 3.88888888888889 3.77777777777778 3.66666666666667 3.66666666666667 4.5 4.66666666666667 5];
%x(6,:) = [3 2.6 1 3 3 5 5 1 1 2.25 3.5 1 1 1 1 1 2 3 4 4 1 3 5 4 3 2 1 1 3 2.66666666666667 3.33333333333333 5 4.8 4.6 4.4 4.2 4 2.5 2.25 2.66666666666667 3.25 3.83333333333333 4.41666666666667 5 3 1 1.66666666666667 2.33333333333333 3 3.66666666666667 4.33333333333333 5 5 3 1 1 3 3.5 1.5 1 1.5 1.5 1 2 2.5 1 2 3.33333333333333 2.33333333333333 2.25 3.5 2.875 2.25 1.625 1 2 3 3 3.5 4 4 1 1 1 3 3 3 3 3 3 3 2.33333333333333 1 2.5 2.66666666666667 2 3 5 4.33333333333333 3.66666666666667 3 2.33333333333333 1.66666666666667 1 3 5 1 1 5 3 1 2 2 1.5 1 2 2.5 1.75 1 1.5 2 4 2.5 3 5 4.8 4.6 4.4 4.2 4 4 4 4 4 4 4 3 2 2.5 3 3 2.55555555555556 2.11111111111111 1.66666666666667 1.66666666666667 2.11111111111111 2.55555555555556 3 3 2 1 2.5 2.5 1 1 1 1 1 1 1 1 1 2.33333333333333 3.66666666666667 5 5 1 1 3 3 3 3 2 1 5 5 5 5 5 5 5 1 3.75 4 3 4 2 1.5 1 2 3 4 5 5 4 3 2.33333333333333 1.66666666666667 1 1];
%x(7,:) = [4.5 5 5 5 5 5 5 4.5 4 5 5 5 5 5 5 5 5 5 5 5 5 5 3 3 5 4.83333333333333 4.9 5 5 5 5 5 5 5 4.66666666666667 4.8 5 5 5 5 5 5 5 4.6 4.33333333333333 5 4.6 4.5 5 5 5 5 5 5 5 5 4.8 4.625 5 5 5 4.91666666666667 4.92307692307692 5 5 4.75 4.8125 5 5 5 5 4.77777777777778 4.77777777777778 5 5 4.9375 4.9 5 4.75 4.8 5 5 5 5 5 5 5 4.66666666666667 4.71428571428571 4.90909090909091 5 5 5 4.88888888888889 4.75 5 5 5 4.6 4.66666666666667 4.75 4.66666666666667 4.8 4.75 5 5 5 5 4.71428571428571 4.71428571428571 4.83333333333333 4.9 4.92857142857143 4.89655172413793 4.85365853658537 4.82608695652174 5 4.5 4.6 5 4.875 4.81818181818182 4.875 5 5 5 4.90909090909091 4.88888888888889 4.9375 5 3.66666666666667 4.28571428571429 4.5 4.46153846153846 4.64285714285714 4.85 4.95454545454545 5 5 5 4.81818181818182 4.84615384615385 5 4.81818181818182 4.71428571428571 5 5 5 5 5 5 5 5 5 5 3 1 5 5 5 5 5 4.2 4.16666666666667 4.75 5 5 5 5 5 5 5 4.33333333333333 4.2 5 5 5 4.2 4 5 5 5 5 5 4.5 4.66666666666667 5 5 5 4 4.33333333333333 4.66666666666667 4.5 5 5 5 5 5 5 5];
%x(8,:) = [5 4.75 4.5 4.5 5 5 3 2.5 3.33333333333333 3.33333333333333 4.5 5 5 5 5 4.5 4 1 2.5 4.5 5 5 5 5 5 3 1 2 2 3 4 5 5 3 3 3 3.5 4 3 3 1 3 5 5 5 5 5 5 3.66666666666667 3 5 5 5 5 5 5 5 5 5 5 4.5 4 4 3 3.5 4.5 5 4.5 4 4 3 2 2 2.125 2.25 2.375 2.5 2.625 2.75 2.875 3 3.5 4.5 5 4 4 3.5 3 3 5 5 3 3 4 4 4 4 4 4 3.88888888888889 3.875 4.5 4.55555555555556 4.66666666666667 2.6 1.8 2.33333333333333 3.33333333333333 3.33333333333333 1.66666666666667 2.2 2.33333333333333 2.88888888888889 3.44444444444444 4 4 2.5 3.5 4.33333333333333 4 4 4.5 5 5 5 5 5 2.5 3.33333333333333 5 1.5 2.66666666666667 5 4 3.5 3.33333333333333 4.16666666666667 5 4 4 5 5 5 3 1 1 2.5 4 4 3 2 1.5 1.5 2 2.16666666666667 2.33333333333333 2.5 2.66666666666667 2.83333333333333 3 3 3.66666666666667 4.33333333333333 5 4.5 4.5 5 5 5 5 5 4.6 4.2 3.8 3.4 3 3 3.5 4 2.5 1 3 5 5 5 4.5 4 3.5 3 3 3 3 3 3 3 3 3 3 3 3];
%x(9,:) = [2 3.5 5 5 4.25 3.5 2.75 2 2 2 5 5 5 5 4 4 5 3.5 2 2 5 3.75 3.16666666666667 2.4 3 3.83333333333333 4 3.66666666666667 3.33333333333333 4 5 4 2.66666666666667 3.33333333333333 5 4.16666666666667 3.33333333333333 3.33333333333333 5 5 3 2 3.33333333333333 3.33333333333333 2.91666666666667 2.5 2.5 2 1.5 1 2.66666666666667 4 5 5 5 5 4 3.5 2 1 3 2.6 2 2.66666666666667 4 4.5 3.66666666666667 4.33333333333333 5 5 3.8 3.2 2.66666666666667 1 5 5 5 4 4 3.33333333333333 2.66666666666667 2 2 4 3 2.5 3 3.125 3.25 3.375 3.5 3.8 4.25 5 5 5 4.16666666666667 3.33333333333333 2.5 2.2 1.75 1 3 4 5 5 5 3.8 3 1 5 5 3 3.75 3.33333333333333 2.5 4 4.5 5 5 3 3.66666666666667 5 4.83333333333333 4.66666666666667 4.5 4.33333333333333 4 4.25 4.5 4.75 5 5 4.25 3.5 3.5 3.625 3.75 3.875 4 4 3.8 3.6 3.4 3.2 3 4 5 4.75 4.5 4.25 4 4.33333333333333 5 4.33333333333333 3.66666666666667 3 3 2.8 2.6 2.4 2.2 2 2 2 2.4 2.8 3.2 3.6 4 4 4 4 4 4 4 4.25 4.5 4.75 5 5 2 2 5 5 5 5 4.66666666666667 4.33333333333333 4 3 2 2 2 2 2 3.5 5 5 5];
%x(10,:) = [4.09945355191257 4.54972677595629 5 5 5 5 5 4.5 4 5 5 5 5 1.4 2 3.5 3 2.6 3 2.875 1.9 1.25 1.75 1.85714285714286 1.2 1.6 2 5 3.85714285714286 2.33333333333333 3 3 2.33333333333333 1.66666666666667 1 3 3.66666666666667 3.66666666666667 3 1 2 4 4.66666666666667 5 4.83333333333333 4.66666666666667 4.66666666666667 1 2 4 5 4 2 1 2 2 1.75 1.5 3 4 4.33333333333333 5 4.66666666666667 3 2 2 2 2 4.5 4.5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4.42857142857143 3.85714285714286 3.28571428571429 2.71428571428572 2.14285714285714 1.57142857142857 1 1 1 3.66666666666667 4.66666666666667 4 5 5 4.5 4.5 4.52380952380952 4.54761904761905 4.57142857142857 4.59523809523809 4.61904761904762 4.64285714285714 4.66666666666667 4.66666666666667 3.44444444444444 2.22222222222222 1 1 1.375 1.75 2.125 2.5 2.875 3.25 3.625 4 4.28571428571429 4.33333333333333 1 2 3 3 3 1 2.5 4.5 4.5 4 4.5 5 3.5 2 2.75 3.5 4.25 5 5 5 5 5 4.90909090909091 4.81818181818182 4.72727272727273 4.63636363636364 4.54545454545455 4.45454545454546 4.36363636363636 4.27272727272727 4.18181818181818 4.09090909090909 4 4 3.5 3 4 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5];
%x(11,:) = [3.33333333333333 4.66666666666667 5 4 4 5 5 4.5 4 3.5 3 3 4 5 3.66666666666667 4 4.2 3 2.5 5 4.25 3.5 5 5 4.66666666666667 4.66666666666667 4.5 4.33333333333333 2.5 3 2.75 2.6 3 4 5 4.5 4.66666666666667 5 5 4 3.6 4.14285714285714 4.66666666666667 2 2 1 2.5 4.25 4.33333333333333 4 3.5 2 1 1.66666666666667 2 3 3.2 3.5 4.5 4.5 3.5 3.4 4.33333333333333 4.125 2.83333333333333 3.66666666666667 4.125 3.6 3.83333333333333 3.5 3 3.83333333333333 4.28571428571429 3.6 2.2 2.25 3 3 2 1 1 2.33333333333333 3.66666666666667 3 2.25 2.5 4 3.5 3.22222222222222 3.625 3 2.5 4 4 5 5 4 4 3.33333333333333 3.66666666666667 5 5 4.5 4 3 2 2 2 2 2 4 3.33333333333333 3.75 4.6 4.4 4.5 4.33333333333333 3 3.5 4 4.5 5 4 3.25 2.5 3.41666666666667 4.33333333333333 4.33333333333333 4 4 4.16666666666667 4.33333333333333 4.5 4.66666666666667 4.66666666666667 2 1.5 2.5 3.8 3.66666666666667 3.2 3.33333333333333 3 2.75 3 5 3.5 4 5 5 4 3 2 1 1 1 3.33333333333333 4.5 3.875 3.25 2.625 2 2 2.66666666666667 3.33333333333333 4 4 5 5 5 5 4.33333333333333 3.66666666666667 3 3.66666666666667 4 5 3.25 1.5 1.5 5 4.66666666666667 4.5 3 4 5 3 1 1.66666666666667 2.33333333333333 3 3 3 3 3 3 3 3 3 3];
%x(12,:) = [4.86363636363636 4.83333333333333 4.82142857142857 5 4.88888888888889 4.35714285714286 4.4375 4.9 5 5 5 5 5 5 4.875 4.8 4.2 4.42857142857143 5 4.8 4.16666666666667 4 4.33333333333333 4.5 4.66666666666667 5 5 4.83333333333333 4.88888888888889 5 5 5 5 5 5 5 5 5 5 4.6 4.21428571428571 4.41666666666667 4.71428571428571 4 4.33333333333333 5 5 5 4.58823529411765 4.45833333333333 4.17391304347826 4.36363636363636 4.875 4.70588235294118 4.81818181818182 4.5 4.37931034482759 4.55555555555556 4.38461538461539 4.25 4.09090909090909 4.38888888888889 4.84210526315789 4.78947368421053 4.9 5 4.54545454545455 4.16666666666667 4.33333333333333 4.71428571428571 4.69230769230769 4.73333333333333 4.9 4.54545454545455 3.75 4.375 4.90909090909091 4.83333333333333 5 5 5 4.625 4.5 3.75 3 4 4.71428571428571 4.33333333333333 4.15384615384615 4.46666666666667 4.53846153846154 4.28571428571429 4.5 4.83333333333333 5 5 4.66666666666667 4 3.33333333333333 3 4 4.4 4.33333333333333 4.5 4.5 5 5 5 5 4.375 4.16666666666667 5 4 4.66666666666667 4.81818181818182 4.53846153846154 4.57142857142857 5 4.875 4.75 4.8 4.85714285714286 5 3.85714285714286 3.66666666666667 4.33333333333333 3 3.5 4.6 4.75 4.33333333333333 4 4.33333333333333 4.6 4.85714285714286 4.75 4.8 4.45454545454545 4.14285714285714 4.75 4 4.1 4.625 4.57142857142857 4.5 5 4 3 3.75 4.5 4.66666666666667 5 5 5 5 5 5 5 5 4.75 4.5 4.5 2 2 5 4 4 5 5 5 4 4 4.5 4 4 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4.66666666666667 4 4.5 5 5 5 5 5 5];
%x(13,:) = [4.25 4.25 5 5 3.6 3.33333333333333 3.33333333333333 4.5 4.6 3 1 3 4 4.33333333333333 4.6 4.375 4.25 5 5 4 4.16666666666667 4 4 3.42857142857143 3.5 4.8 4 4 4.5 5 5 5 5 4.75 4.66666666666667 4.33333333333333 3.6 3.8 4.125 4.16666666666667 4.5 4 5 4.66666666666667 4.66666666666667 5 5 5 4 3.5 3 4.2 5 3.5 4 3 3.6 4.5 4.25 3.75 4.33333333333333 5 4.66666666666667 4.33333333333333 3.33333333333333 3 3.25 3.42857142857143 4.25 5 5 5 4 4.66666666666667 5 5 4.66666666666667 4.5 5 5 5 4.66666666666667 4.33333333333333 4 4.5 4.66666666666667 4 3 4 4.2 4 5 5 4.66666666666667 4 3 3.83333333333333 4.75 5 5 3.5 2.33333333333333 3.83333333333333 4.5 4.5 4.5 4.5 4.66666666666667 4.83333333333333 5 4.25 4.25 5 5 5 5 5 5 5 5 5 5 5 4.25 3.5 3.5 5 5 3 3 3.33333333333333 3.66666666666667 4.16666666666667 4.6 4.75 4.66666666666667 4 5 5 5 5 5 5 4 4.5 5 5 4.66666666666667 4.33333333333333 4 4 4 4 4.5 5 5 4.5 4 3 2.66666666666667 4 5 5 5 5 5 4 3 3 5 5 5 5 5 4.75 4.5 4.25 4 4 4 4 4.2 4.4 4.6 4.8 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5];

%x = (5*sin(t/3.7+.3)+3*sin(t/1.3+.1)+2*sin(t/34.7+.7)); %This is the measured signal
% x = x-1;

x(1,:) = [4.6 4.5 4.5 4.4 4.4 4.7 4.5 4.2 4 3.8 3.5 3.5 3.6 3.9 3.8 4.2 4.3 4.2 3.5 3.8 3.6 3.3 3.3 3.8 3.7 3.6 4 4 3.9 3.6 3.8 3.9 3.8 4 4.3 4.3 4.1 4.5 4.3 4.1 3.8 3.9 3.9 3.8 4 4.3 4.1 3.8 4.1 3.9 4 4 4.3 4.4 4.4 3.9 3.9 3.8 3.2 3.1 3.5 3.6 3.4 3.6 4 3.3 3.3 3.2 3.3 3 3.7 3.4 3.5 3.5 3.4 3.4 3.4 3.3 3.5 3.7 3.4 3.7 4.1 3.8 3.8 4.1 4.1 4.1 4.4 3.8 3.5 3.3 3.3 2.9 3.7 3.8 3.8 3.3 3.8 3.7 3.6 3.5 3.7 3.1 3 3.2 3.6 3.5 3.6 3.6 3.8 3.5 3.9 4 4 3.7 3.9 3.5 3.6 3.4 3.6 3.6 3.4 3.4 3.6 3.4 3.4 3.4 3.5 3.7 3.6 3.6 3.9 3.9 3.7 3.5 3.7 4 3.8 4 4.6 4.6 4.6 4.9 4.7 4.6 4.2 4.1 3.9 4 4 4.1 4.2 4.4 4.3 4 4.2 3.9 3.8 3.9 3.9 3.9 4 4.2 3.9 4.2 4 4 4 3.7 3.7 3.9 4 3.8 4.3 4.1 3.7 3.7 3.8 3.7 3.5 3.8 3.4 3.4 3.4 3.6 3.7 4.1 4.2 4 4.1 3.9 3.4 3 3.3 3.2 3.2 3.7 4.1 4.2];
x(2,:) = [2.8 2.3 2.3 2.6 3 2.7 3.1 3.3 3.3 2.9 3.1 3 3.1 2.7 3.1 3 2.8 2.5 2.6 2.6 2.1 2.3 1.9 1.9 1.5 1.5 1.1 1.1 1.6 1.8 2.5 2.9 3.4 3.2 3.4 3.3 3 2.9 2.9 2.8 2.5 2.4 2.3 2.6 2.7 2.8 3.2 3.3 2.6 2.6 2.2 2.2 2.2 2.2 1.8 1.8 1.4 1.1 1.8 1.8 2.6 3.4 3.7 3.1 3.2 2.4 2 1.9 1.8 2 2.3 2.3 2.5 3.3 3.2 3.5 3.2 2.8 2.6 3.1 2.8 2.9 3.1 2.5 1.8 1.9 2.3 2.4 2.4 2.7 2.7 2.6 2.6 2.9 2.6 2.6 2.7 2.3 2.8 3.5 3.6 3.3 3.8 3.2 2.9 3.2 2.9 2.5 2.7 3.1 2.7 2.7 3 3.2 3.2 3.2 3.2 3.2 3 2.2 2.2 2.5 2.6 2.2 2.6 2.6 2.3 2.2 2.6 2.2 1.8 2 2 2 2.4 2.5 2.7 3 2.6 2.9 3.1 3.1 3.2 3.4 3.1 2.8 2.8 2.5 3.1 3.1 3.4 3 2.5 2.1 2.1 2.5 3.3 3.7 3.3 3.5 3.6 3.2 3.3 3.3 3.1 2.4 2.4 2.6 3.2 3.6 4.3 3.9 3.7 3.8 3.7 2.9 3.6 3.9 3.9 3.8 4.6 4.3 3.8 3.5 3.6 3.5 3.9 3.9 4.1 3.8 3.1 2.7 2.7 2.2 2.6 2.8 2.7 2.4 2.5 1.7];
x(3,:) = [4.9 5 5 5 4.9 4.9 4.5 4.4 4.3 4.1 4.1 4.5 4.6 4.6 4.9 4.9 4.9 4.8 4.9 4.9 4.8 4.8 4.9 4.9 4.9 4.9 4.9 4.9 4.9 4.7 4.6 4.6 4.5 4.5 4.2 4.3 4.3 4.4 4.3 4.8 4.9 4.5 4.5 4.1 4.1 4.1 4.1 4.1 4.6 4.6 4.5 4.9 4.9 4.9 4.9 4.6 4.6 4.6 4.6 4.6 4.6 4.6 3.8 3.8 3.8 4.2 4.2 5 5 5 5 5 5 5 5 4.9 4.8 4.8 4.8 4.6 4.5 4.6 4.2 4.2 3.7 3.9 3.8 4.2 4.2 4.9 4.9 5 5 4.9 4.7 4.3 4.3 4.3 4.3 4.4 4.6 4.4 4.4 4.1 3.9 4.1 4.3 4.2 4.6 4.9 4.9 4.9 4.7 4.7 4.7 4.3 4.3 4.6 4.6 4.4 4.8 4.5 4.5 4.5 4.7 4.7 5 5 4.8 4.8 4.8 4.8 4.8 4.7 4.7 4.5 4.5 4.5 4.7 4.7 4.8 4.8 4.8 4.9 4.9 5 5 4.6 4.6 4.6 4.6 4.5 4.9 4.9 4.5 4.5 4.5 4.5 4.5 4.5 4 4 3.9 3.9 4.2 4.7 4.8 4.9 4.9 4.9 4.8 4.8 4.8 4.8 4.9 5 5 5 5 5 5 5 4.6 4.6 3.8 3.6 3.6 4 4 4.8 5 5 5 4.5 4 3.4 3.3 3.1 3.6 4.1];
x(4,:) = [1.9 1.9 1.4 1.4 1.7 1.8 1.8 2 2.3 2.2 2.5 2.5 2.7 2.1 1.8 1.4 1.6 1.4 1.8 1.8 1.8 1.6 1.4 1.5 1.9 1.9 2.5 2.9 2.7 2.5 2.5 2.3 2.3 2.3 2.5 2.5 2.1 2.2 2.3 1.9 1.9 2.3 2.1 1.7 1.7 2.1 1.9 1.6 2.1 2.1 2.1 2.5 2.5 2 2 1.6 1 1.4 1.5 1.7 1.8 1.8 1.8 1.7 1.9 2.2 2.6 2.4 2.4 2 1.6 1.6 1.4 1.4 2.1 2.2 1.9 2 2.3 1.7 2.3 2.2 2.1 2.3 2.2 1.6 1.6 2 1.5 1.7 1.8 2.1 2.1 2.3 2.1 2.5 2.8 2.7 2.5 2.9 2.3 1.7 1.8 1.9 2.3 2.5 2.5 2.1 2.4 2 1.8 2 2.7 2.7 3 3 2.9 2.7 2.8 2.2 2.7 2.8 2.3 1.8 1.7 1.2 1.4 1.4 1.7 1.7 2.4 2.4 2.4 2.1 2.9 3 2.6 2.6 2.6 2.2 1.5 1.9 2 2.4 2 1.9 1.5 2.2 1.8 1.8 2.2 3 2.2 2.2 2.3 1.9 1.1 1.5 1.9 1.8 1.8 1.8 1.4 1 1.4 2.2 2.2 2.2 2.2 1.8 1.4 1.7 1.7 1.7 2.1 2.1 1.8 1.8 1.8 1.4 1 1.2 1.6 1.8 2.5 2.5 2.4 2.4 2.5 1.8 2.1 2.4 2 2.1 2.9 3.2 3.2 3.5 3.4 3];
x(5,:) = [4.1 4.4 4.3 4.2 3.8 3.9 3.6 3.5 3.4 3.3 2.8 3.2 3.3 2.8 2.9 3.4 2.8 2.7 3.1 3.2 3.1 3.4 2.8 3.2 3.1 3.1 3.2 4 4 4.4 4 4 3.6 3.3 2.5 3.1 2.9 3.3 3.2 3.6 3.8 4 3.3 3.6 3.8 3.4 3.2 3.7 3.7 3.8 3.4 3.5 3.6 2.9 2.6 3.2 3.3 2.8 3.6 3.4 3.2 3 3 2.4 2.8 2.8 3 3.1 3 2.8 3.1 2.9 2.8 3.1 3.1 2.4 2.4 2.3 2.2 2.4 2.6 2.9 3.2 3.5 3.3 3.5 3.6 3.5 3 3 3.2 3.1 2.8 3.2 3.5 3.4 3.5 4.2 3.9 3.4 3.6 3.3 2.8 2.6 3 2.3 2.2 2.7 3.1 3.3 3.9 3.6 2.9 3.2 3 3.2 3.9 4.4 4.3 4.4 3.9 3.6 3.6 3.5 3.4 3.6 3.7 3.8 3.8 3.7 3.8 4 4 4.3 3.9 3.5 2.7 2.8 2.7 3.1 3.3 4 3.6 3.4 3.7 3.4 3 3.3 3.2 3 3.2 3.2 3 3 2.7 2.9 2.6 2.8 3 2.9 2.7 3.3 2.9 2.7 3.3 3 3 2.8 2.8 2.3 2.4 2.2 2.9 2.7 3.1 3.5 3.1 3 3.2 3 3.3 3.6 3.8 4 4 3.5 3.9 3.5 3.2 3.4 3.3 2.8 2.6 2.7 2.2 2.8 2.7 3 3.1 3.6];
x(6,:) = [4.4 4.1 4 3.8 3.5 3 3.1 3.3 3.6 3.6 4.1 3.9 3.6 3.2 3.6 3 3.1 3.3 3.7 3.6 4.2 4.4 4.2 3.5 3.2 2.8 2.4 2.8 2.8 3.2 2.9 3 2.8 3.6 3.2 3.4 3.5 3.8 3.6 3.7 4.1 3.9 3.6 3.8 3.7 3.7 4 4.1 3.8 3.9 3.7 3.4 3.3 3.5 3.8 3.8 3.8 3.3 3.2 2.8 3.1 2.8 2.9 2.4 2.2 1.7 2.2 2.6 3.1 3.3 3.3 3 3.1 3.3 3.3 3.6 4 3.7 3.2 3.4 3.4 3.5 3.7 3.6 3.4 3.4 3.1 2.9 3.3 3.1 2.8 2.7 2.8 2.2 2 2.1 2.4 2 2.1 2.5 2.7 2.4 3.1 3.3 3.3 2.8 2.9 2.4 2.8 2.5 3 2.9 3.1 2.8 2.7 2.7 2.9 3.1 2.7 3.4 3.3 3.5 3.2 3.2 2.5 2.4 2 2 2.5 3.1 3.3 3.4 3.6 3.5 3.6 3.3 3.1 3.3 3.2 3.3 3.7 4.2 3.7 4.2 3.5 3.1 3.1 3.4 3 3.5 3.5 3.5 3.4 3 3.1 2.8 2.2 2.5 2.9 2.7 3.1 3.4 3 2.8 2.3 2.2 2.1 2.2 2.8 3.6 3.5 3.3 2.9 2.2 1.4 1.2 1.6 1.9 2 2.3 2.5 2 1.7 2.2 1.9 2.5 3 3.2 3 3.7 3.3 3.3 3.3 2.8 2.5 2.5 2.5 2.8 3.6 3.9];
x(7,:) = [4.6 4.5 4.5 4.5 4.5 4.9 5 5 5 4.9 4.9 4.9 4.9 4.9 5 5 4.6 4.6 4.6 4.6 4.6 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4.8 4.8 4.8 4.8 4.8 5 4.9 4.9 4.9 4.9 4.9 5 4.6 4.6 4.5 4.5 4.5 4.9 4.9 5 4.7 4.2 4.1 4.1 4.1 4.4 4.9 5 5 5 5 5 4.9 4.9 4.9 4.9 4.9 5 5 4.9 4.8 4.8 4.8 4.8 4.9 5 5 4.9 4.9 4.9 4.9 4.9 5 5 4.9 4.8 4.8 4.8 4.8 4.9 5 5 5 5 5 5 5 5 5 5 5 4.9 4.9 4.9 4.9 4.9 5 5 5 5 5 5 5 5 5 4.9 4.9 4.9 4.8 4.8 4.9 4.9 4.9 5 5 5 4.9 4.9 4.9 4.8 4.8 4.9 4.9 4.9 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 4.9 4.9 4.5 4.5 4.5 4.6 4.6 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5 5];
x(8,:) = [4.4 4.1 4.3 4 3.8 3.4 2.9 2.6 2.6 2.4 2.7 3.2 3.2 3.1 3.7 3.6 3.5 3.8 4.2 3.9 3.6 3.8 3.8 3.9 3.4 3.5 3.3 2.9 2.9 3.6 3.8 4.2 4.6 4.4 4.5 4.5 4 3.9 4 3.5 3.2 3.3 3.5 3.1 3.4 3.9 4.2 4.2 4.7 4.9 4.8 4.8 4.7 4.5 4.3 3.8 3.8 3.1 2.8 2.6 3.1 2.5 3.3 3.8 4.1 4 4.6 4.6 4.3 4.4 4.4 4.2 4.1 4 3.3 3.3 3.5 3.6 3.5 4.1 4 3.7 3.6 3.9 3.4 2.9 2.6 2.7 2.8 3.3 4.1 4.2 3.4 2.7 2.6 2.2 2 2.4 3.1 3.1 3.3 4.1 4.1 4.2 4.4 4.5 4.5 4.6 4.2 4.2 4.1 3.8 3.7 4 3.2 2.7 3 2.8 2.3 2.7 2.9 2.7 3.3 3.9 4.3 4.1 4 3.9 3.5 3.4 4 4.2 4.3 4.1 3.9 3.3 2.9 2.7 3.2 3.3 3.9 4.3 4.3 4.3 4.4 4.5 4.6 4.4 4.4 4.4 4.1 3.7 3.9 3.3 3.3 3.2 2.9 3 3.7 3.2 3.2 3.8 3.7 3.1 3.7 3.7 3.6 3.8 4.1 3.7 3.8 3.3 3.3 3.5 3.9 4.2 4.5 4.3 3.9 3.5 2.9 3.2 3.4 3.5 3.9 4.5 4.4 4.4 4.7 4.1 3.6 3.7 3.5 3.3 3.9 4 3.6 3.7 4 3.6];
x(9,:) = [3.9 3.8 4 4.4 4.5 4.4 4.6 4.5 4 4.1 4.3 4.3 4.1 4.6 4.5 4.6 4.2 4.3 4.1 4 3.8 3.6 3.3 3.4 3.5 3.6 4.2 4.7 4.8 4.6 4.7 4.4 4.4 4.4 4.1 3.9 4.2 4.2 4.1 4.4 4.6 4.6 4.5 4.6 4.9 4.7 4.1 4.1 3.4 2.8 2.6 3.1 3.2 3.7 3.6 3.8 3.7 3.7 3.9 4.6 4.6 4.8 4.4 4.3 4.2 4.3 4.3 4.4 4.3 4 4.1 3.5 3.4 3.6 4 3.9 4.5 4.6 4.4 4.4 4.1 4.1 4.3 4.1 3.9 4.2 4.1 4.2 4.5 4.4 4.3 4 4 3.9 4.2 4.4 4.6 4.5 4.7 4.3 4.1 4.1 4 3.9 3.9 4 3.9 4.1 4 4.2 4.3 4.4 4.4 4.6 4.5 4.2 3.9 3.9 3.8 3.9 4.2 4.7 4.7 4.8 5 4.8 4.8 4.5 3.9 3.6 3.8 3.3 3.3 3.3 3.3 2.9 3.1 3.3 3.4 3.4 3.6 3.4 3.5 3.9 4.1 4 4.5 4.5 4.4 4.5 4.5 4.5 4.1 4.3 4.1 4.4 4.3 4.6 4.6 4.6 4.5 4.5 4.6 4.6 4.5 4.6 4.7 4.7 4.6 4.9 4.9 4.5 4.4 4.1 3.7 3.6 3.7 3.5 3.8 4.2 4.3 4.6 4.5 4.4 4.4 4.4 4.4 4.8 4.5 4.5 4.1 3.8 3.4 3.5 3.3 3.7 4 4 3.9 4.1];
x(10,:) = [4.5 4.5 4.9 4.9 4.9 4.7 4.6 4.7 4.7 4.7 4.8 4.9 4.4 4.3 4.3 4.4 4.4 4.5 4.1 4.1 4.1 4.1 4.5 5 4.8 4.8 4.4 4.4 4.4 4.6 4.6 5 5 5 5 5 4.7 4.6 4.6 4.3 4.3 4.6 4.7 4.6 4.8 4.8 4.4 4.2 4.2 4.3 4.3 4.7 4.9 5 5 5 5 4.8 4.7 4 3.7 3.7 3.9 3.7 4.4 4.7 4.7 4.7 5 5 4.9 4.5 4.5 4.1 4.1 4.2 4.5 4.5 4.9 4.8 4.7 4.8 4.8 4.4 3.7 3.7 3.7 3.3 3.5 3.9 4 4 4.3 4.5 4.9 4.5 4.5 4.6 4.4 4.4 4.8 4.7 4.7 4.8 4.8 4.4 4.5 4.5 4.6 4.4 4.7 4.3 4.1 3.8 4 4 4.2 4.4 4.7 4.3 4.4 3.8 3.6 3.5 3.5 3.2 3.7 3.1 3.2 3.6 3.4 3.6 4.4 4.3 4.3 4.3 4.4 4.3 4 4 4.4 4.4 4.5 4.9 4.8 4.7 4.3 4.1 4.1 4.2 4.2 4.4 4.5 4.5 4.2 4 3.8 3.9 3.5 3.6 3.8 4.2 4.2 4.5 4.7 4.5 4.5 4.4 4.4 4 4.4 4.1 4.1 4 4.2 3.9 3.9 3.7 3.8 3.9 4.2 4.2 4.5 4.3 3.8 3.8 4.1 4.1 4.3 4.9 4.9 4.9 4.8 4.9 4.4 4.4 4.3 4.4 4.4 4.8];
x(11,:) = [3.8 4.3 4.7 4.6 4.1 3.9 3.9 3.8 3.7 4 3.6 3.4 3.4 2.8 2.9 2.7 2.9 2.7 3.4 3.7 3.9 3.6 3.5 3.4 3 3.4 3.2 3.5 2.9 3 3.1 3.3 2.6 2.6 2.6 2.6 2.7 3.1 3.6 3.9 3.6 3.3 3.2 3.3 3.4 3.3 3.8 3.9 4.1 3.3 3.2 2.5 2.3 1.9 2.3 2.8 3.2 3.4 3.4 3 2.7 2.5 2.1 2 2.2 2.2 2.7 3.2 3.3 3.3 3.7 3.5 3.7 3.8 3.6 3.2 3.1 3 2.7 3 2.9 2.8 2.4 2.8 2.9 2.9 2.6 2.6 2.8 3 2.9 3.1 3 2.5 2.5 3 3.5 3.6 3.8 3.6 3.4 3.2 3.2 3.5 3.1 3.3 2.8 3 2.3 2.7 2 1.9 1.9 2.5 2.4 3.1 3.3 3.1 2.4 2.7 2.1 2.6 2.8 3.4 3.6 3.8 3.8 3.9 4 3.3 3.1 2.7 2.5 2.6 3.1 3.8 4.3 4.4 3.9 3.7 3.5 2.9 3.2 3.6 3.6 3.7 3.9 4 3.4 3.8 3.5 3.6 3.6 3.6 3.5 3.4 3.6 3.6 4.3 4.2 4.2 4.1 3.9 3.6 3.7 3.9 4.1 3.9 4.2 4.2 4.5 4.5 4.8 4.7 4.5 4.4 4.2 4.1 4.2 4 3.6 3.4 3.5 2.9 3.3 3.6 3.6 3.5 3.8 3.7 3.5 3.5 3.1 3.3 3.4 3.8 3.7 4 3.9 3.7];
x(12,:) = [4.7 4.8 4.8 5 5 4.9 4.9 4.9 4.9 4.9 5 4.6 4.6 4.6 4.5 4.5 4.9 4.9 4.9 5 5 5 5 5 5 5 4.9 4.5 4.5 4.5 4.1 4.2 4.6 4.5 4.5 4.9 4.9 4.9 5 5 5 5 4.9 4.9 4.8 4.5 4.5 4.6 4.5 4.6 4.5 4.5 4.3 4.4 4.3 4.7 4.7 4.8 4.8 4.9 4.9 4.9 5 5 5 5 5 5 5 5 5 5 5 5 4.6 4.6 4.2 4.2 3.9 4.3 4.3 4.7 4.5 4.4 4.4 4.4 4.4 4.6 5 5 4.9 4.9 4.8 4.8 4.3 4.4 4.4 4.1 4.1 4.4 4.4 4.4 4 3.7 3.9 3.7 3.7 4.5 4.8 4.7 4.9 4.9 4.8 4.8 4.9 4.9 4.9 5 4.9 4.6 4.6 4.6 4.6 4.7 5 5 5 5 4.9 4.2 4.1 4 3.6 3.7 4.3 4.4 4.3 4.7 4.7 4.8 4.6 4.8 4.4 4.4 4.3 4.3 4.3 4.5 4.5 4.2 4.2 4.2 4.3 3.7 4 3.9 3.8 3.9 4.5 4.6 4.9 5 4.8 4.8 4.8 4.7 4.7 4.9 4.8 4.8 4.9 4.9 4.9 5 5 4.6 4.6 4.5 4.1 4 4.3 4.3 4.3 4.7 4.8 4.9 4.6 4.7 4.7 4.7 4.6 4.9 4.9 4.9 4.8 4.6 4.5 4 4 4.1];
x(13,:) = [4.9 4.9 4.7 4.6 4.5 4.5 4.4 4.2 4.3 4.3 4.3 4.3 4.6 4.2 4.3 4.3 4.4 4.6 5 4.7 4.4 4.2 4.2 4.2 4.5 4.7 4.9 4.9 4.9 4.8 4.4 4.1 3.5 3.3 3.1 3.4 3.2 3.2 2.8 2.8 3 3.4 3.9 4.4 4.7 4.6 4.7 4.8 4.9 4.9 5 5 4.9 4.9 4.9 4.9 4.9 5 5 4.9 4.8 4.8 4.7 4.6 4.7 4.8 4.4 4.5 4.2 4.2 4.2 4.6 4.5 4.9 4.8 4.8 4.8 4.7 4 3.7 3.7 3.6 3.7 4.4 4.8 4.8 4.8 4.9 4.9 4.8 4.8 4.9 4.9 4.7 4.8 4.8 4.3 4.1 4.2 4.1 4.1 4.6 4.4 4.3 4.4 4.2 4.2 4.4 4.4 4.4 4.6 4.6 4.2 4.3 4.3 4.2 4.1 4.4 4.1 4 4 4 4.3 4.4 4.3 4.3 4.4 4.2 3.7 3.6 3.5 3.2 2.9 3.7 3.9 4.1 4.3 4.4 4.3 4.4 4 3.9 3.7 3.5 3.5 3.4 3.4 4 4.2 4.1 4.5 4.7 4.5 4.5 4.4 4.1 3.7 3.6 3.5 3.2 3.1 3 2.8 2.6 2.8 3.1 3.5 4 4.2 4.2 4 3.6 3.1 2.9 2.8 2.4 2.8 3 3.4 3.8 4.4 4.3 4.6 4.5 4.4 4.6 4.8 4.8 4.9 5 4.9 4.9 4.6 4.4 4.4 4.5 4.4 4.7 4.9 4.9];


N = 100;     % Order of LPC auto-regressive model
P = 200;    % Number of samples in the extrapolated time series
M = 100;    % Point at which to start predicting
t = 1:P;

OldDifference = 0.0;
NewDifference = 0.0;
Accuracy = 0.0;

for xN=1:13
    xOrig = x(xN,:);
    % x(xN,:) = sgolayfilt(x(xN,:),10,21);

    a = lpc(x(xN,:),N);

    est_x = zeros(1, P);
    % fill in the known part of the time series
    est_x(1:M) = x(xN,1:M);

    %disp('-----');
    p = polyfit([1:100],x(xN,1:100),1);
    %disp('p: '); disp(p);

    p2 = polyfit([1:200],x(xN,1:200),1);
    %disp('p: '); disp(p);
    
    aDiff = 1 + sum(a(2:end));
        %disp('Old aDiff: '); disp(aDiff);
    % aDiff = abs((-1 - p(1)) - sum(a(2:end)));
        %disp('New aDiff: '); disp(aDiff);
        %disp('Old a:'); disp(sum(a(2:end)));
    a = a - (aDiff / size(a(2:end),2));
        %disp('New a:'); disp(sum(a(2:end)));

    for ii=(M+1):P
        est_x(ii) = -sum(a(2:end) .* est_x((ii-1):-1:(ii-N)));
    end
    
    %%% Write figure
    f = figure;
    
    ha = area([100 P], [5.2 5.2]);
    set(ha,'FaceColor',[.9 .9 .9]);
    
    %hb = area([0 100], [5.2 5.2]);
    %set(hb,'FaceColor',[1 1 1]);

    hold on
    % plot(xOrig);
    plot(t, x(xN,:), t, est_x, t, p(1)*t+p(2), t, p2(1)*t+p2(2), 'LineWidth',2);
    % axis([0 P min(est_x) max(est_x)])
    legend('Test Set','Amazon Dataset','Prediction','Linear fit of first 100','Linear fit of all 200','Location','SouthWest');
    axis([0 P 0 5.2])
    % refline(0,mean(x(1:100)));
    xlabel('Days')
    ylabel('Average Ratings'); 
    hold off

    set(gcf,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[6.7, 5]);
    % set(gcf, 'PaperPositionMode', 'auto');
    print(f,strcat('Plot',int2str(xN),'.pdf'),'-r0','-dpdf');
    close; 
    
    rank(xN,1) = mean(x(xN,1:100));
    rank(xN,2) = mean(est_x(100:200));
    rank(xN,3) = mean(x(xN,100:200));

    OldDifference = OldDifference + abs( rank(xN,1) - rank(xN,3) );
        %disp('OldDifference: '); disp(abs( rank(xN,1) - rank(xN,3) ));
    NewDifference = NewDifference + abs( rank(xN,2) - rank(xN,3) );
        %disp('NewDifference: '); disp(abs( rank(xN,2) - rank(xN,3) ));
    Accuracy = Accuracy + abs( rank(xN,3) - rank(xN,2) );
end

improvement = ((OldDifference-NewDifference)/OldDifference)*100;

disp(strcat('Difference of training & testing:   ',num2str(OldDifference)));
disp(strcat('Difference of training and predicted:   ',num2str(NewDifference)));
disp(strcat('Difference of testing and predicted:   ',num2str(Accuracy)));
disp(strcat('Improvement of preduction over testing:   ',num2str(improvement),'%'));



f2 = figure;
bar(rank);
legend('First 100','Prediction of Second 100','Second 100','Location','SouthWest');
set(gcf,'PaperPositionMode','Auto','PaperUnits','Inches','PaperSize',[6.7, 5.3]);
axis([0 size(rank,1)+1 0 5.2])
xlabel('Data Set')
ylabel('Average Ratings'); 
print(f2,'BarGraph.pdf','-r0','-dpdf');